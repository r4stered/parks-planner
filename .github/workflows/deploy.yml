name: Deploy to Netlify

on:
  push:
    branches: [main]
  pull_request:
    branches: [main]

jobs:
  # Netlify will handle the actual build and deployment via webhook
  # This workflow just validates the code
  validate:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: "3.12"

      - name: Install uv
        uses: astral-sh/setup-uv@v4

      - name: Install dependencies
        run: uv sync

      # Just validate that the script runs without errors
      - name: Validate generation script
        env:
          # Use dummy values for validation
          FIREBASE_API_KEY: "dummy"
          FIREBASE_AUTH_DOMAIN: "dummy.firebaseapp.com"
          FIREBASE_DATABASE_URL: "https://dummy.firebaseio.com"
          FIREBASE_PROJECT_ID: "dummy"
          FIREBASE_STORAGE_BUCKET: "dummy.appspot.com"
          FIREBASE_MESSAGING_SENDER_ID: "123456"
          FIREBASE_APP_ID: "dummy"
        run: uv run python -c "from generate_site import *; print('Script validates successfully')"
